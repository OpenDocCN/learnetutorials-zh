<html>
<head>
<title>Python exec()</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Python exec（）</h1>
<blockquote>原文:<a href="https://learnetutorials.com/python/methods/exec">https://learnetutorials.com/python/methods/exec</a></blockquote>&#13;
                         &#13;
                        <p>这个内置函数有助于执行动态创建的程序。exec()函数接收要执行的字符串或代码块。它被解析并作为 python 语句执行。</p>

<div class="syntax">
<pre>
<code class="python">
<strong>exec(object, globals, locals) </strong>#Where object can be a string or a code object
 </code>
</pre>
</div>

<p><strong>安全风险</strong></p>

<p>如果我们使用一个 Unix 系统(macOS、Linux 等)并导入一个操作系统模块，它有助于提供操作系统功能，如文件的读、写。并且用户使用<code>exec(input())</code>输入一个值，它可以使用命令<code>os.system('rm -rf *')</code>发出改变文件甚至删除所有文件的命令。</p>

<h2>exec()参数:</h2>

<p>取 3 个参数，其中第一个参数是一个对象，如果该对象是一个字符串，它将作为 python 语句执行，如果它是一个打开的文件，那么它将一直执行到 EOF，如果它是一个代码对象，那么它将被简单地执行。</p>

<table>
 <thead>
  <tr>
   <th scope="col">参数</th>
   <th scope="col">描述</th>
   <th scope="col">必需/可选</th>
  </tr>
 </thead>
 <tbody>
  <tr>
   <td>目标</td>
   <td>字符串或代码对象</td>
   <td>需要</td>
  </tr>
  <tr>
   <td>全球</td>
   <td>包含全局变量的字典。</td>
   <td>可选择的</td>
  </tr>
  <tr>
   <td>当地人</td>
   <td>包含局部变量的字典。</td>
   <td>可选择的</td>
  </tr>
 </tbody>
</table>

<h2>exec()返回值</h2>

<p>它不返回值。它只是执行给定的字符串或代码对象。</p>

<h2>Python 中 exec()方法的示例</h2>

<div class="code-example">
<h3>示例 1:简单的执行示例</h3>

<pre>
<code class="python">
x = 1

exec('print(x==1)')

exec('print(x+2)') 
 </code>
</pre>
</div>

<p><strong>输出:</strong></p>

<div class="output">
<pre>
<samp>True
3
</samp></pre>
</div>

<div class="code-example">
<h3>示例 2:Python exec()动态代码执行示例</h3>

<pre>
<code class="python">
from math import *

for l in range(1, 3):

    func = input("Enter Code Snippet to execute:\n")
    try:
        exec(func)
    except Exception as ex:
        print(ex)
        break
print('Done')
 </code>
</pre>
</div>

<p><strong>输出:</strong></p>

<div class="output">
<pre>
<samp>Enter Code Snippet to execute:
print(sqrt(16))
4.0
Enter Code Snippet to execute:
print(min(2,1))
1
Done
</samp></pre>
</div>

<div class="code-example">
<h3>示例 3:将空字典作为全局参数传递</h3>

<pre>
<code class="python">
from math import *
exec('print(dir())', {})

# This code will raise an exception
# exec('print(sqrt(9))', {})
 </code>
</pre>
</div>

<p><strong>输出:</strong></p>

<div class="output">
<pre>
<samp>['__builtins__']
</samp></pre>
</div>

<div class="code-example">
<h3>示例 4:传递全局和局部字典</h3>

<pre>
<code class="python">
from math import *

globalsParameter = {'__builtins__' : None}
localsParameter = {'print': print, 'dir': dir}
exec('print(dir())', globalsParameter, localsParameter)
 </code>
</pre>
</div>

<p><strong>输出:</strong></p>

<div class="output">
<pre>
<samp>['dir', 'print']
</samp></pre>
</div>
                        
</body>
</html>